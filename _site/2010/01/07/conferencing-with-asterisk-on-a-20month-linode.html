<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="utf-8">
      <meta name="author" content="Creative Commons">
      <meta name="viewport" content="width=device-width">
      <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css">
      <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap-theme.min.css">
      <link rel="stylesheet" href="/css/main.css">
      <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
      <link rel="icon" href="/favicon.ico" type="image/x-icon">
      <link rel="alternate" type="application/atom+xml" href="/atom.xml">
      <title>Conferencing with Asterisk on a $20/month Linode&mdash;Creative Commons Labs</title>
   </head>
   
   <body>

<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">Creative Commons Labs</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li class="active"><a href="/">Home</a></li>
            <li><a href="/about">About</a></li>
            <li><a href="/blog">Read our blog</a></li>
            <li><a href="/contact">Contact</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

<div class="container">

      <div class="starter-template">

	<h1><a href="/">Creative Commons Labs</a></h1>

	<p><small>Website of the Creative Commons tech team.
</small>
	</p>

      </div>

      <div class="row">

	<div class="col-md-12">

  	<div class="post">

  
  <div class="bg-danger text-center" id="old-posts">
    <p>Please note, this is an old blog post from several years ago. It may contain out of date information. If you spot anything broken or missing, <a target="_blank" href="https://github.com/creativecommons/labs/issues">please file a bug</a>.</p>
  </div>
  

  <header class="post-header">
    <h1 class="post-title">Conferencing with Asterisk on a $20/month Linode</h1>
    <p class="post-meta">Jan 7, 2010 by nkinkade</p>
  </header>

  <article class="post-content">
    <p>For quite some years CC has been using <a href="http://www.freeconferencecall.com/">Free Conference Call</a> for tele-conferencing needs.  It generally worked pretty well, but people frequently complained of not being able to connect, or getting erroneously dropped into some empty conference room, and things of that nature ... to say nothing of the <a href="http://arstechnica.com/business/news/2007/03/attcingular-blocks-cellular-customers-from-free-conference-call-services.ars">questionable practices</a> used by services like Free Conference Call that allow them to make a service like that free.  Paid conferencing systems are actually quite expensive, and CC doesn't have the resources to be able to roll out some $10,000 to $20,000 custom conferencing system.  We ended up deciding to setup <a href="http://asterisk.org">Asterisk</a> on one of our servers.  We didn't really want to load one of our core servers, so we decided to give it a try on a $20/month <a href="http://linode.com">Linode</a> which we were already using for server monitoring.</p>
<p>Getting Asterisk installed on a Debian system is as easy as <code>$ apt-get install asterisk</code>.  Configuring it is covered by thousands of other articles on the Internet.  However, the problem is that Debian's default kernel is shipped with a particular configuration that is unacceptable for VoIP applications like Asterisk.  Debian's default kernel sets CONFIG_HZ=250, but for tele-conferencing with Asterisk to have acceptable audio quality it needs to be 1000.  No problem, building a custom Debian kernel package is pretty easy, <em>but</em> we wanted to run this on a Linode <a href="http://en.wikipedia.org/wiki/Virtual_private_server">VPS</a>, which is a <a href="http://www.xen.org">Xen</a> environment.  So the question became how to get Xen patches applied to the vanilla Debian kernel sources.  It may sound trivial, but it actually took me quite some time to work it out.  The first issue was resources -- a $20/month Linode doesn't have many, and the VPS ran out of memory while trying to compile the kernel.  I got around this by killing virtually every other un-needed process.  The next problem was what turned out to be a bug in the Debian <code>kernel-package</code> package, which took me quite a long time to find ... I didn't locate the bug in the code myself, but it took me a long time to realize it was a bug causing my problem and then find the existing bug report and a workaround.</p>
<p>I'll try to post here again soon with the actual steps needed to get this working, partly for the benefit of the community, but also to document what I did in case I ever have to do it again.  For now, suffice it to say that we are successfully running our own conferencing system using <a href="http://en.wikipedia.org/wiki/FOSS">FOSS</a> telephony software (Asterisk) on a $20/month VPS.  Not only does this give us much more control over the system, but it opened up the possibility for people to start calling in via VoIP (<a href="http://en.wikipedia.org/wiki/Session_Initiation_Protocol">SIP</a> or <a href="http://en.wikipedia.org/wiki/Inter-Asterisk_eXchange">IAX</a>!) software instead of dialing in through the <a href="http://en.wikipedia.org/wiki/Public_switched_telephone_network">PSTN</a>.  This saves CC even more money because dialing into our conferencing system through the PSTN is not free.  For that we had to find a good <a href="http://en.wikipedia.org/wiki/Direct_inward_dialing">DID</a> provider.   We ended up going with <a href="http://www.flowroute.com/">Flowroute</a> and so far I've been very happy with their service.  Their rates are very competitive (< 1Â¢/minute), and the web interface for account management is very clean and intuitive.  We have had conference calls with 20 people and the call quality has been just fine.  Not only that, we can set up as many conference rooms as we want and hold multiple conferences simultaneously.</p>
<p><strong>UPDATE</strong>: <em>Wed Aug 11 21:56:24 UTC 2010</em> <a rel="nofollow" href="http://pc.de/pages/conferencing-with-asterisk-be">Belorussian</a> translation provided by Patricia Clausnitzer.</p>

  </article>

</div>


	</div>

      </div>
      

    <footer>

    <p><a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a></p>

    <p>Except where otherwise noted, content on this site is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</p>

    </footer>

    </div><!-- /.container -->

    <script async src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script async src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>

  </body>
</html>
